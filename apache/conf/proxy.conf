<VirtualHost *:80>
    ServerName localhost

    # Redirigir /api al backend FastAPI (ajusta el host si es diferente)
    ProxyPreserveHost On
    ProxyRequests Off

    # Asegúrate de que estos módulos estén habilitados:
    # - proxy
    # - proxy_http
    # - rewrite (si usas redirecciones)

    <Proxy *>
        Require all granted
    </Proxy>

    # Redirección de /api al servicio FastAPI
    ProxyPass "/api" "http://fastapi:8000/api"
    ProxyPassReverse "/api" "http://fastapi:8000/api"

    # Servir archivos estáticos
    DocumentRoot "/usr/local/apache2/htdocs"
    <Directory "/usr/local/apache2/htdocs">
        Options -Indexes +FollowSymLinks
        AllowOverride None
        Require all granted
    </Directory>

    # ModSecurity (opcional)
    <IfModule security2_module>
        SecRuleEngine On
    </IfModule>
</VirtualHost>
